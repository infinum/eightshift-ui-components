// AUTO-GENERATED FILE. DO NOT EDIT.
// Run the build-worker script to update.
export default "(function(){\"use strict\";var v=(t=>(t[t.ALPHA=0]=\"ALPHA\",t[t.BLUE=1]=\"BLUE\",t[t.GREEN=2]=\"GREEN\",t[t.RED=3]=\"RED\",t))(v||{});const ke=[\"rotateCW\",\"rotate180\",\"rotateCCW\"],Jn=(t,e=t,n,r={})=>{const s=document.createElement(\"canvas\");return tr(s,t,e,r.dpr),r.pixelated&&(s.style.imageRendering=\"pixelated\"),{canvas:s,ctx:s.getContext(\"2d\",r.ctx)}},Qn=(t,e=t,n,r)=>Jn(t,e,n,{dpr:1,...r}),tr=(t,e,n,r=window.devicePixelRatio||1)=>(r!==1&&(t.style.width=`${e}px`,t.style.height=`${n}px`),t.dataset.origWidth=String(e),t.dataset.origHeight=String(n),t.dataset.dpr=String(r),t.width=e*r,t.height=n*r,r),Ut=t=>typeof t==\"number\";function er(t,e,n,r){let s,i;if(Ut(t)){const c=Qn(t,e,n,r);s=c.canvas,i=c.ctx}else s=t,i=s.getContext(\"2d\");const a=i.getImageData(0,0,s.width,s.height),o=new Uint32Array(a.data.buffer);return{canvas:s,ctx:i,img:a,data:o}}const st=(t,e,n)=>{n.configurable=!1},ot=(t,e={})=>{const n=Reflect.ownKeys(t),r=Reflect.ownKeys(e),s=Symbol(\"isa\");function i(a){for(let o of n){const c=Object.getOwnPropertyDescriptor(a.prototype,o);(!c||c.configurable)&&Object.defineProperty(a.prototype,o,{value:t[o],writable:!0})}return Object.defineProperty(a.prototype,s,{value:!0}),a}for(let a of r)Object.defineProperty(i,a,{value:e[a],enumerable:e.propertyIsEnumerable(a)});return Object.defineProperty(i,Symbol.hasInstance,{value:a=>!!a[s]}),i};ot({order(){return[0]},includes(t){return t>=0&&t<this.size[0]},indexAt(t){return this.includes(t)?this.indexAtUnsafe(t):-1},indexAtUnsafe(t){return this.offset+(t|0)*this.stride[0]},getAt(t){return this.includes(t)?this.data[this.indexAtUnsafe(t)]:0},getAtUnsafe(t){return this.data[this.indexAtUnsafe(t)]},setAt(t,e){return this.includes(t)?(this.data[this.indexAtUnsafe(t)]=e,!0):!1},setAtUnsafe(t,e){return this.data[this.indexAtUnsafe(t)]=e,!0}});const Me=ot({order(){return Math.abs(this.stride[1])>Math.abs(this.stride[0])?[1,0]:[0,1]},includes(t,e){const n=this.size;return t>=0&&t<n[0]&&e>=0&&e<n[1]},indexAt(t,e){return this.includes(t,e)?this.indexAtUnsafe(t,e):-1},indexAtUnsafe(t,e){return this.offset+(t|0)*this.stride[0]+(e|0)*this.stride[1]},getAt(t,e){return this.includes(t,e)?this.data[this.indexAtUnsafe(t,e)]:0},getAtUnsafe(t,e){return this.data[this.indexAtUnsafe(t,e)]},setAt(t,e,n){return this.includes(t,e)?(this.data[this.indexAtUnsafe(t,e)]=n,!0):!1},setAtUnsafe(t,e,n){return this.data[this.indexAtUnsafe(t,e)]=n,!0}});ot({order(){return Ue(this.stride)},includes(t,e,n){const r=this.size;return t>=0&&t<r[0]&&e>=0&&e<r[1]&&n>=0&&n<r[2]},indexAt(t,e,n){return this.includes(t,e,n)?this.indexAtUnsafe(t,e,n):-1},indexAtUnsafe(t,e,n){const r=this.stride;return this.offset+(t|0)*r[0]+(e|0)*r[1]+(n|0)*r[2]},getAt(t,e,n){return this.includes(t,e,n)?this.data[this.indexAtUnsafe(t,e,n)]:0},getAtUnsafe(t,e,n){return this.data[this.indexAtUnsafe(t,e,n)]},setAt(t,e,n,r){return this.includes(t,e,n)?(this.data[this.indexAtUnsafe(t,e,n)]=r,!0):!1},setAtUnsafe(t,e,n,r){return this.data[this.indexAtUnsafe(t,e,n)]=r,!0}}),ot({order(){return Ue(this.stride)},includes(t,e,n,r){const s=this.size;return t>=0&&t<s[0]&&e>=0&&e<s[1]&&n>=0&&n<s[2]&&r>=0&&r<s[3]},indexAt(t,e,n,r){return this.includes(t,e,n,r)?this.indexAtUnsafe(t,e,n,r):-1},indexAtUnsafe(t,e,n,r){const s=this.stride;return this.offset+(t|0)*s[0]+(e|0)*s[1]+(n|0)*s[2]+(r|0)*s[3]},getAt(t,e,n,r){return this.includes(t,e,n,r)?this.data[this.indexAtUnsafe(t,e,n,r)]:0},getAtUnsafe(t,e,n,r){return this.data[this.indexAtUnsafe(t,e,n,r)]},setAt(t,e,n,r,s){return this.includes(t,e,n,r)?(this.data[this.indexAtUnsafe(t,e,n,r)]=s,!0):!1},setAtUnsafe(t,e,n,r,s){return this.data[this.indexAtUnsafe(t,e,n,r)]=s,!0}});const Ue=t=>[...t].map((e,n)=>[e,n]).sort((e,n)=>Math.abs(n[0])-Math.abs(e[0])).map(e=>e[1]),Ee=t=>typeof t==\"string\",nr=(t,e=n=>n!==void 0?\": \"+n:\"\")=>class extends Error{origMessage;constructor(n){super(t(n)+e(n)),this.origMessage=n!==void 0?String(n):\"\"}},rr={};var Ie={};const sr=nr(()=>\"Assertion failed\"),R=(typeof process<\"u\"&&Ie!==void 0?Ie.UMBRELLA_ASSERTS:!rr)?(t,e)=>{if(typeof t==\"function\"&&!t()||!t)throw new sr(typeof e==\"function\"?e():e)}:()=>{},M=(t,e,n)=>t<e?e:t>n?n:t,X=t=>t<0?0:t>1?1:t,ze=(t,e,n,r,s)=>(t[0]=e,t[1]=n,t[2]=r,t[3]=s,t),or=(t,e)=>{const n=e[3];return ze(e,e[0]*n,e[1]*n,e[2]*n,n)},ir=t=>{const e=(t>>>24)/255;return t&4278190080|(t>>>16&255)*e<<16|(t>>>8&255)*e<<8|(t&255)*e},ar=(t,e)=>{const n=e[3];return n>0?ze(e,e[0]/n,e[1]/n,e[2]/n,n):e},cr=t=>{const e=(t>>>24)/255;return e>0?(t&4278190080|Math.min(255,(t>>>16&255)/e)<<16|Math.min(255,(t>>>8&255)/e)<<8|Math.min(255,(t&255)/e))>>>0:t},lr=t=>{const e=t[3];return t[0]<=e&&t[1]<=e||t[2]<=e},hr=t=>{const e=t>>>24;return(t>>>16&255)<=e&&(t>>>8&255)<=e&&(t&255)<=e},xe=(t,e,n,r=1)=>R(t.length>=e*n*r,\"pixel buffer too small\"),Oe=(t,e,n)=>t?(Et(t,e,n),t):new ImageData(e,n),Et=(t,e,n)=>R(t.width===e&&t.height===n,\"imagedata has wrong dimensions\"),F=(t,e)=>{const n=t.channels[e];return R(n!=null,`invalid channel ID: ${e}`),n},fr=t=>R(!!t.alpha,\"missing alpha channel\"),It=t=>t,zt=t=>((t>>>16&255)*29+(t>>>8&255)*150+(t&255)*76)/255,it=(t,e,n,r,s,i,a=0,o=0)=>(t|=0,e|=0,n|=0,r|=0,t<0&&(n+=t,a-=t,t=0),e<0&&(r+=e,o-=e,e=0),[t,e,M(n,0,s-t),M(r,0,i-e),a,o]),at=(t,e,n={})=>{const r=t.width,s=e.width;let i,a,o,c,l,h;return[i,a,l,h]=it(n.sx||0,n.sy||0,n.w||r,n.h||t.height,r,t.height),[o,c,l,h,i,a]=it(n.dx||0,n.dy||0,l,h,s,e.height,i,a),{sx:i,sy:a,dx:o,dy:c,rw:l,rh:h}},ur=(t,e,n)=>{for(let r=t.length;r-- >0;)t[r]=n(t[r],e)},dr=(t,e,n,r)=>{for(let s=t.length;s-- >0;)t[s]=r(t[s],n(e[s]))},gr=(t,e,n,r,s)=>{const i=~s;for(let a=t.length;a-- >0;)t[a]=t[a]&i|n(r(e[a]))&s},Fe=(t,e,n)=>{const r=e.fromABGR,s=e.toABGR;for(let i=t.length;i-- >0;)t[i]=r(n(s(t[i])))},De=(t,e,n={})=>(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext(\"2d\"):e).putImageData(t.toImageData(n.data),n.x||0,n.y||0),xt=t=>{const e=t.channels,n=e.reduce((a,o)=>(a[o]=3-o<<3,a),{}),r={...t,__float:!0,size:e.length,shift:n,range:[0,1],normalized:X,fromNormalized:It};if(t.convert)return Object.assign(r,t.convert),r;const s=(a,o)=>(X(a[o])*255+.5|0)<<n[e[o]],i=(a,o)=>(a>>>n[e[o]]&255)/255;switch(e.length){case 1:t.gray?yr(r):mr(r,i,s);break;case 2:t.gray?Ar(r,i):br(r,i,s);break;case 3:_r(r,i,s);break;case 4:pr(r,i,s);break}return r},mr=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s)},yr=t=>{t.toABGR=e=>((X(e[0])*255+.5|0)*65793|4278190080)>>>0,t.fromABGR=(e,n=[])=>(n[0]=zt(e)/255,n)},br=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s|=n(r,1),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s[1]=e(r,1),s)},Ar=(t,e)=>{const n=~~(t.channels[0]===v.ALPHA),r=n^1;t.toABGR=s=>{let i=(X(s[n])*255+.5|0)*65793;return i|=(s[r]*255+.5|0)<<24,i>>>0},t.fromABGR=(s,i=[])=>(i[n]=zt(s)/255,i[r]=e(s,r),i)},_r=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s|=n(r,1),s|=n(r,2),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s[1]=e(r,1),s[2]=e(r,2),s)},pr=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s|=n(r,1),s|=n(r,2),s|=n(r,3),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s[1]=e(r,1),s[2]=e(r,2),s[3]=e(r,3),s)},wr=xt({gray:!0,channels:[v.RED]}),Rr={5120:\"i8\",5121:\"u8\",5122:\"i16\",5123:\"u16\",5124:\"i32\",5125:\"u32\",5126:\"f32\"},$r={f32:Float32Array,f64:Float64Array},Cr={i8:Int8Array,i16:Int16Array,i32:Int32Array},vr={u8:Uint8Array,u8c:Uint8ClampedArray,u16:Uint16Array,u32:Uint32Array},Br={i64:BigInt64Array,u64:BigUint64Array},Sr={...$r,...Cr,...vr},Gr=t=>{const e=Rr[t];return e!==void 0?e:t};function ct(t,...e){const n=Br[t];return new(n||Sr[Gr(t)])(...e)}const kr=t=>t>16?\"u32\":t>8?\"u16\":\"u8\",Ot=(t,e)=>e>0?`(${t} << ${e})`:e<0?`(${t} >>> ${-e})`:`${t}`,Ft=(t,e)=>Ot(t,-e),Ne=t=>`0x${t.toString(16)}`,Mr=t=>{const e=8-t,n=(1<<t)-1;return new Function(\"luma\",`return (x) => ${Ft(\"luma(x)\",e)} & ${n};`)(zt)},Ur=t=>{let e;if(t!==8){const n=(1<<t)-1,r=255/n;e=`(((x & ${n}) * ${r}) | 0)`}else e=\"x\";return new Function(\"x\",`return 0xff000000 | (${e} * 0x010101);`)},Er=t=>new Function(\"x\",\"return (\"+t.map(e=>{const n=e.abgrShift+(8-e.size);return`(${Ft(\"x\",n)} & ${Ne(e.maskA)})`}).join(\" | \")+\") >>> 0;\"),Ir=(t,e)=>{const n=t.map(s=>{if(s.size!==8){const i=s.mask0,a=255/i,o=Ft(\"x\",s.shift);return Ot(`((${o} & ${i}) * ${a})`,24-s.lane*8)}else return Ot(`(x & ${Ne(s.maskA)})`,s.abgrShift)}).join(\" | \"),r=e?\"\":\"0xff000000 | \";return new Function(\"x\",`return (${r}${n}) >>> 0;`)},zr=(t,e,n)=>{const r=1<<t.size,s=r-1,i=s<<n>>>0,a=~i>>>0,o=t.lane!=null?t.lane:e,c=h=>h>>>n&s,l=(h,u)=>h&a|(u&s)<<n;return{size:t.size,num:r,abgrShift:24-o*8-n,lane:o,shift:n,mask0:s,maskA:i,int:c,setInt:l,float:h=>c(h)/s,setFloat:(h,u)=>l(h,X(u)*s)}},Te=t=>{R(t.channels.length>0,\"no channel specs given\");const e=t.channels.reduce(([n,r],s,i)=>(r-=s.size,n.push(zr(s,i,r)),[n,r]),[[],t.size])[0];return{__packed:!0,type:t.type,size:t.size,alpha:t.alpha||0,channels:e,fromABGR:t.fromABGR||Er(e),toABGR:t.toABGR||Ir(e,!!t.alpha)}},Dt=Te({type:\"u32\",size:32,alpha:8,channels:[{size:8,lane:v.ALPHA},{size:8,lane:v.BLUE},{size:8,lane:v.GREEN},{size:8,lane:v.RED}],fromABGR:It,toABGR:It}),qe=(t,e,n,r,s,i)=>{const a=1-s,o=1-i;return t*a*o+e*s*o+n*a*i+r*s*i},K=(t,e,n,r,s)=>{r*=.5;const i=-.5*t+1.5*e-1.5*n+r,a=t-2.5*e+2*n-r,o=-.5*t+.5*n,c=e,l=s*s;return s*l*i+l*a+s*o+c},Pe=(t,e,n,r,s,i,a,o,c,l,h,u,f,d,g,m,b,A)=>K(K(t,e,n,r,b),K(s,i,a,o,b),K(c,l,h,u,b),K(f,d,g,m,b),A),lt=(t,e)=>t-e*Math.floor(t/e),B=t=>t-Math.floor(t);function je(t,e=\"linear\",n=\"clamp\"){const r=!!t.format.__float,s=t.format.channels.length===1?\"1\":\"\",i=`${e[0]}${n[0]}${s}`,a=(r?{nc1:ht,nw1:ft,nr1:ut,nc:ht,nw:ft,nr:ut,lc1:o=>Nt(T(o)),lw1:o=>Nt(q(o)),lr1:o=>Nt(P(o)),lc:o=>qt(o,ht(o)),lw:o=>qt(o,ft(o)),lr:o=>qt(o,ut(o)),cc1:o=>jt(T(o)),cw1:o=>jt(q(o)),cr1:o=>jt(P(o)),cc:o=>Ht(o,ht(o)),cw:o=>Ht(o,ft(o)),cr:o=>Ht(o,ut(o))}:{nc1:T,nw1:q,nr1:P,nc:T,nw:q,nr:P,lc1:o=>dt(T(o)),lw1:o=>dt(q(o)),lr1:o=>dt(P(o)),lc:o=>Tt(o,T(o)),lw:o=>Tt(o,q(o)),lr:o=>Tt(o,P(o)),cc1:o=>Pt(o,T(o)),cw1:o=>Pt(o,q(o)),cr1:o=>Pt(o,P(o)),cc:o=>Lt(o,T(o)),cw:o=>Lt(o,q(o)),cr:o=>Lt(o,P(o))})[i];return R(!!a,`missing impl for ${i}`),a(t)}const T=({data:t,width:e,height:n})=>(r,s)=>r>=0&&r<e&&s>=0&&s<n?t[(s|0)*e+(r|0)]:0,q=({data:t,width:e,height:n})=>(r,s)=>t[lt(s|0,n)*e+lt(r|0,e)],P=({data:t,width:e,height:n})=>{const r=e-1,s=n-1;return(i,a)=>t[M(a|0,0,s)*e+M(i|0,0,r)]},ht=({data:t,width:e,height:n,stride:[r,s]})=>(i,a)=>{let o;return i>=0&&i<e&&a>=0&&a<n?(o=(a|0)*s+(i|0)*r,t.slice(o,o+r)):[0]},ft=({data:t,width:e,height:n,stride:[r,s]})=>(i,a)=>{let o=lt(a|0,n)*s+lt(i|0,e)*r;return t.slice(o,o+r)},ut=({data:t,width:e,height:n,stride:[r,s]})=>{const i=e-1,a=n-1;return(o,c)=>{let l=M(c|0,0,a)*s+M(o|0,0,i)*r;return t.slice(l,l+r)}},Z=(t,e,n,r,s=4)=>qe(t[r],t[r+s],t[r+2*s],t[r+3*s],e,n),dt=t=>(e,n)=>(e-=.5,n-=.5,qe(t(e,n),t(e+1,n),t(e,n+1),t(e+1,n+1),B(e),B(n))),Nt=t=>(t=dt(t),(e,n)=>[t(e,n)]),Tt=(t,e)=>{const{fromABGR:n,toABGR:r}=t.format,s=new Uint32Array(4),i=new Uint8Array(s.buffer);return(a,o)=>{a-=.5,o-=.5,s[0]=r(e(a,o)),s[1]=r(e(a+1,o)),s[2]=r(e(a,o+1)),s[3]=r(e(a+1,o+1));const c=B(a),l=B(o);return n(Z(i,c,l,0)|Z(i,c,l,1)<<8|Z(i,c,l,2)<<16|Z(i,c,l,3)<<24)>>>0}},qt=({stride:[t]},e)=>{const n=new Float32Array(t*4);return(r,s)=>{r-=.5,s-=.5,n.set(e(r,s),0),n.set(e(r+1,s),t),n.set(e(r,s+1),t*2),n.set(e(r+1,s+1),t*3);const i=B(r),a=B(s);let o=[];for(let c=0;c<t;c++)o.push(Z(n,i,a,c,t));return o}},Le=t=>(e,n)=>{e-=.5,n-=.5;const r=e-1,s=e+1,i=e+2,a=n-1,o=n+1,c=n+2;return Pe(t(r,a),t(e,a),t(s,a),t(i,a),t(r,n),t(e,n),t(s,n),t(i,n),t(r,o),t(e,o),t(s,o),t(i,o),t(r,c),t(e,c),t(s,c),t(i,c),B(e),B(n))},Pt=(t,e)=>{const n=t.format.channels[0].mask0;return e=Le(e),(r,s)=>M(e(r,s),0,n)},jt=t=>(t=Le(t),(e,n)=>[t(e,n)]),He=(t,e,n,r,s=4)=>Pe(t[r],t[r+s],t[r+2*s],t[r+3*s],t[r+4*s],t[r+5*s],t[r+6*s],t[r+7*s],t[r+8*s],t[r+9*s],t[r+10*s],t[r+11*s],t[r+12*s],t[r+13*s],t[r+14*s],t[r+15*s],e,n),gt=(t,e,n,r,s=4)=>M(He(t,e,n,r,s),0,255),Lt=(t,e)=>{const{fromABGR:n,toABGR:r}=t.format,s=new Uint32Array(16),i=new Uint8Array(s.buffer);return(a,o)=>{a-=.5,o-=.5;const c=a-1,l=a+1,h=a+2,u=o-1,f=o+1,d=o+2,g=B(a),m=B(o);return s[0]=r(e(c,u)),s[1]=r(e(a,u)),s[2]=r(e(l,u)),s[3]=r(e(h,u)),s[4]=r(e(c,o)),s[5]=r(e(a,o)),s[6]=r(e(l,o)),s[7]=r(e(h,o)),s[8]=r(e(c,f)),s[9]=r(e(a,f)),s[10]=r(e(l,f)),s[11]=r(e(h,f)),s[12]=r(e(c,d)),s[13]=r(e(a,d)),s[14]=r(e(l,d)),s[15]=r(e(h,d)),n(gt(i,g,m,0)|gt(i,g,m,1)<<8|gt(i,g,m,2)<<16|gt(i,g,m,3)<<24)>>>0}},Ht=({stride:[t]},e)=>{const n=new Float32Array(t*16);return(r,s)=>{r-=.5,s-=.5;const i=r-1,a=r+1,o=r+2,c=s-1,l=s+1,h=s+2,u=B(r),f=B(s);n.set(e(i,c),0),n.set(e(r,c),t),n.set(e(a,c),2*t),n.set(e(o,c),3*t),n.set(e(i,s),4*t),n.set(e(r,s),5*t),n.set(e(a,s),6*t),n.set(e(o,s),7*t),n.set(e(i,l),8*t),n.set(e(r,l),9*t),n.set(e(a,l),10*t),n.set(e(o,l),11*t),n.set(e(i,h),12*t),n.set(e(r,h),13*t),n.set(e(a,h),14*t),n.set(e(o,h),15*t);let d=[];for(let g=0;g<t;g++)d.push(He(n,u,f,g,t));return d}};var xr=Object.getOwnPropertyDescriptor,Or=(t,e,n,r)=>{for(var s=r>1?void 0:r?xr(e,n):e,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s};function Fr(...t){return t[0]instanceof U?t[0].as(t[1]):new U(...t)}const Dr=(t,e=Dt)=>{const{data:n}=er(t),r=t.width,s=t.height;let i;if(e===Dt)i=n;else{i=ct(e.type,r*s);const a=n,o=e.fromABGR;for(let c=i.length;c-- >0;)i[c]=o(a[c])}return new U(r,s,e,i)};let U=class{size;stride;format;data;constructor(t,e,n=Dt,r){this.size=[t,e],this.stride=[1,t],this.format=n.__packed?n:Te(n),this.data=r||ct(n.type,t*e)}get pixels(){return this.data}get width(){return this.size[0]}get height(){return this.size[1]}get offset(){return 0}get dim(){return 2}*[Symbol.iterator](){yield*this.data}as(t){if(!t.__float)return this.getRegion(0,0,this.width,this.height,t);const e=new $(this.width,this.height,t),{data:n,format:r,stride:[s]}=e,{data:i,format:a}=this;for(let o=i.length;o-- >0;)n.set(r.fromABGR(a.toABGR(i[o])),o*s);return e}copy(){const t=this.empty();return t.data.set(this.data),t}empty(){return new U(this.width,this.height,this.format)}order(){}includes(t,e){}indexAt(t,e){}indexAtUnsafe(t,e){}getAt(t,e){}getAtUnsafe(t,e){}setAt(t,e,n){}setAtUnsafe(t,e,n){}getChannelAt(t,e,n,r=!1){const s=F(this.format,n),i=this.getAt(t,e);return r?s.float(i):s.int(i)}setChannelAt(t,e,n,r,s=!1){const i=F(this.format,n),a=this.getAt(t,e);return s?i.setFloat(a,r):i.setInt(a,r),this}blend(t,e,n){let r=this.width,s=e.width;const{sx:i,sy:a,dx:o,dy:c,rw:l,rh:h}=at(this,e,n);if(l<1||h<1)return e;const u=this.data,f=e.data,d=this.format.toABGR,g=e.format.toABGR,m=e.format.fromABGR;for(let b=(i|0)+(a|0)*r,A=(o|0)+(c|0)*s,N=0;N<h;N++,b+=r,A+=s)for(let O=0;O<l;O++)f[A+O]=m(t(d(u[b+O]),g(f[A+O])));return e}blit(t,e){let n=this.width,r=t.width;const{sx:s,sy:i,dx:a,dy:o,rw:c,rh:l}=at(this,t,e);if(c<1||l<1)return t;const h=this.data,u=t.data,f=this.format.toABGR,d=t.format.fromABGR,g=this.format!==t.format?(m,b)=>{for(let A=0;A<c;A++)u[b+A]=d(f(h[m+A]))}:(m,b)=>u.set(h.subarray(m,m+c),b);for(let m=(s|0)+(i|0)*n,b=(a|0)+(o|0)*r,A=0;A<l;A++,m+=n,b+=r)g(m,b);return t}blitCanvas(t,e={}){De(this,t,e)}setImageData(t){Et(t,this.width,this.height);const e=new Uint32Array(t.data.buffer),n=this.data,r=this.format.fromABGR;for(let s=e.length;s-- >0;)n[s]=r(e[s]);return this}toImageData(t){t=Oe(t,this.width,this.height);const e=new Uint32Array(t.data.buffer),n=this.data,r=this.format.toABGR;for(let s=e.length;s-- >0;)e[s]=r(n[s]);return t}getRegion(t,e,n,r,s){const[i,a,o,c]=it(t,e,n,r,this.width,this.height);if(!(o<1||c<1))return this.blit(new U(o,c,s||this.format),{sx:i,sy:a,w:o,h:c})}getChannel(t){const e=F(this.format,t),n=new U(this.width,this.height,{type:kr(e.size),size:e.size,channels:[{size:e.size,lane:v.RED}],fromABGR:Mr(e.size),toABGR:Ur(e.size)}),r=this.data,s=n.data,i=e.int;for(let a=r.length;a-- >0;)s[a]=i(r[a]);return n}setChannel(t,e){const n=F(this.format,t),r=this.data,s=n.setInt;if(Ut(e))ur(r,e,s);else{const i=e.data,a=e.format.channels[0];xe(i,this.width,this.height),n.size===a.size?dr(r,i,a.int,s):gr(r,i,this.format.fromABGR,e.format.toABGR,n.maskA)}return this}invert(){const{data:t,format:e}=this,n=Math.pow(2,e.size-e.alpha)-1;for(let r=t.length;r-- >0;)t[r]^=n;return this}premultiply(){return fr(this.format),Fe(this.data,this.format,ir),this}postmultiply(){return Fe(this.data,this.format,cr),this}isPremultiplied(){const t=this.data,e=this.format.toABGR;for(let n=t.length;n-- >0;)if(!hr(e(t[n])))return!1;return!0}forEach(t){const e=this.data;for(let n=e.length;n-- >0;)e[n]=t(e[n],n);return this}fill(t){this.data.fill(t)}flipX(){const{data:t,width:e}=this;for(let n=0;n<t.length;n+=e)t.subarray(n,n+e).reverse();return this}flipY(){const{data:t,width:e}=this,n=ct(this.format.type,e);for(let r=0,s=t.length-e;r<s;r+=e,s-=e)n.set(t.subarray(r,r+e)),t.copyWithin(r,s,s+e),t.set(n,s);return this}rotateByID(t){return t>0?this[ke[t-1]]():this}rotateCW(){const{width:t,height:e}=this,n=e-1;return this._rotate((r,s)=>r*e+n-s),this.size[0]=e,this.size[1]=t,this}rotateCCW(){const{width:t,height:e}=this,n=t-1;return this._rotate((r,s)=>(n-r)*e+s),this.size[0]=e,this.size[1]=t,this}rotate180(){const{width:t,height:e}=this,n=t-1,r=e-1;return this._rotate((s,i)=>(r-i)*t+n-s),this}scale(t,e=\"linear\"){return R(t>0,\"scale must be > 0\"),this.resize(this.width*t,this.height*t,e)}resize(t,e,n=\"linear\"){t|=0,e|=0,R(t>0&&e>0,\"target width & height must be > 0\");const r=Fr(t,e,this.format),s=r.data,i=t>0?this.width/t:0,a=e>0?this.height/e:0;n=Ee(n)?je(this,n,\"repeat\"):n;for(let o=0,c=0;o<e;o++){const l=o*a;for(let h=0;h<t;h++,c++)s[c]=n(h*i,l)}return r}upsize(){const{width:t,height:e,data:n}=this,r=new U(t*2,e*2,this.format),s=r.data;for(let i=0,a=0;i<e;i++)for(let o=0,c=i*t*4;o<t;o++,a++,c+=2)s[c]=n[a];return r}_rotate(t){const{data:e,format:n,width:r,height:s}=this,i=ct(n.type,r*s);for(let a=0;a<s;a++)for(let o=0;o<r;o++)i[t(o,a)]=e[a*r+o];this.data=i}};U=Or([Me],U);var Nr=Object.defineProperty,Tr=Object.getOwnPropertyDescriptor,J=(t,e,n,r)=>{for(var s=r>1?void 0:r?Tr(e,n):e,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(e,n,s):a(s))||s);return r&&s&&Nr(e,n,s),s};function We(...t){return t[0]instanceof U?qr(...t):new $(...t)}const qr=(t,e)=>{const n=new $(t.width,t.height,e),{data:r,format:s,stride:[i]}=n,{data:a,format:o}=t;for(let c=a.length;c-- >0;)r.set(s.fromABGR(o.toABGR(a[c])),c*i);return n},Pr=(t,e=mt)=>Dr(t).as(e);let $=class{size;stride;format;data;__empty;constructor(t,e,n=mt,r){this.size=[t,e],this.format=n.__float?n:xt(n);const s=this.format.channels.length;this.stride=[s,t*s],this.data=r||new Float32Array(t*e*s),this.__empty=Object.freeze(new Array(s).fill(0))}get pixels(){return this.data}get width(){return this.size[0]}get height(){return this.size[1]}get offset(){return 0}get dim(){return 2}*[Symbol.iterator](){const{data:t,stride:[e]}=this;for(let n=0,r=t.length;n<r;n+=e)yield t.subarray(n,n+e)}as(t){const{width:e,height:n,stride:[r],data:s,format:{size:i,normalized:a,toABGR:o}}=this;let c=0,l=0,h=s.length;if(t.__float){const u=t,f=new $(e,n,u),{data:d,stride:[g]}=f;if(i===1&&u.channels.length===1){const m=u.fromNormalized;for(;c<h;c+=r,l+=g)d[l]=m(a(s[c]))}else for(;c<h;c+=r,l+=g)d.set(u.fromABGR(o(s.subarray(c,c+r))),l);return f}else{const u=t,f=new U(e,n,u),d=f.data;if(i===1&&u.channels.length===1){const g=u.channels[0].setFloat;for(;c<h;c+=r,l++)d[l]=g(0,a(s[c]))}else for(;c<h;c+=r,l++)d[l]=u.fromABGR(o(s.subarray(c,c+r)));return f}}copy(){const t=this.empty();return t.data.set(this.data),t}empty(){return new $(this.width,this.height,this.format)}order(){}includes(t,e){}indexAt(t,e){}indexAtUnsafe(t,e){}getAt(t,e){return this.includes(t,e)?this.getAtUnsafe(t,e):this.__empty}getAtUnsafe(t,e){const n=this.indexAtUnsafe(t,e);return this.data.subarray(n,n+this.stride[0])}setAt(t,e,n){return this.includes(t,e)?(this.data.set(n,this.indexAtUnsafe(t,e)),!0):!1}setAtUnsafe(t,e,n){return this.data.set(n,this.indexAtUnsafe(t,e)),!0}getChannelAt(t,e,n){return F(this.format,n),this.includes(t,e)?this.data[this.indexAtUnsafe(t,e)+n]:void 0}setChannelAt(t,e,n,r){return F(this.format,n),this.includes(t,e)&&(this.data[this.indexAtUnsafe(t,e)+n]=r),this}getChannel(t){F(this.format,t);const{data:e,stride:[n]}=this,[r,s]=this.format.range,i=new Float32Array(this.width*this.height);for(let a=t,o=0,c=e.length;a<c;a+=n,o++)i[o]=M(e[a],r,s);return new $(this.width,this.height,wr,i)}setChannel(t,e){F(this.format,t);const{data:n,stride:[r]}=this;if(Ut(e))for(let s=t,i=n.length;s<i;s+=r)n[s]=e;else{const{data:s,stride:[i]}=e;xe(s,this.width,this.height,i);for(let a=t,o=0,c=n.length;a<c;a+=r,o+=i)n[a]=s[o]}return this}blend(t,e,n){this.ensureFormat(e);const{sx:r,sy:s,dx:i,dy:a,rw:o,rh:c}=at(this,e,n);if(o<1||c<1)return e;const l=this.data,h=e.data,[u,f]=this.stride,d=e.stride[1];for(let g=(r|0)*u+(s|0)*f,m=(i|0)*u+(a|0)*d,b=0;b<c;b++,g+=f,m+=d)for(let A=o,N=g,O=m;A-- >0;N+=u,O+=u){const Mt=h.subarray(O,O+u);t(Mt,l.subarray(N,N+u),Mt)}return e}blit(t,e){this.ensureFormat(t);const{sx:n,sy:r,dx:s,dy:i,rw:a,rh:o}=at(this,t,e);if(a<1||o<1)return t;const c=this.data,l=t.data,[h,u]=this.stride,f=t.stride[1],d=a*h;for(let g=(n|0)*h+(r|0)*u,m=(s|0)*h+(i|0)*f,b=0;b<o;b++,g+=u,m+=f)l.set(c.subarray(g,g+d),m);return t}blitCanvas(t,e={}){De(this,t,e)}setImageData(t){Et(t,this.width,this.height);const e=new Uint32Array(t.data.buffer),{data:n,format:{fromABGR:r},stride:[s]}=this,i=[];for(let a=e.length;a-- >0;)n.set(r(e[a],i),a*s);return this}toImageData(t){t=Oe(t,this.width,this.height);const e=new Uint32Array(t.data.buffer),{stride:[n],data:r,format:s}=this;for(let i=0,a=0,o=r.length;i<o;i+=n,a++)e[a]=s.toABGR(r.subarray(i,i+n));return t}getRegion(t,e,n,r){const[s,i,a,o]=it(t,e,n,r,this.width,this.height);if(!(a<1||o<1))return this.blit(new $(a,o,this.format),{sx:s,sy:i,w:a,h:o})}forEach(t){const{data:e,stride:[n]}=this;for(let r=0,s=0,i=e.length;r<i;r+=n,s++)e.set(t(e.subarray(r,r+n),s),r);return this}fill(t){R(t.length<=this.format.channels.length,\"fill value has too many channels\");const{data:e,stride:[n]}=this;for(let r=0,s=e.length;r<s;r+=n)e.set(t,r)}premultiply(){this.ensureRGBA();const{data:t,stride:[e]}=this;for(let n=0,r=t.length;n<r;n+=e)or(null,t.subarray(n,n+e));return this}postmultiply(){this.ensureRGBA();const{data:t,stride:[e]}=this;for(let n=0,r=t.length;n<r;n+=e)ar(null,t.subarray(n,n+e));return this}isPremultiplied(){this.ensureRGBA();const{data:t,stride:[e]}=this;for(let n=0,r=t.length;n<r;n+=e)if(!lr(t.subarray(n,n+e)))return!1;return!0}clamp(){const t=this.data,[e,n]=this.format.range;for(let r=t.length;r-- >0;)t[r]=M(t[r],e,n);return this}clampChannel(t){F(this.format,t);const{data:e,stride:[n]}=this,[r,s]=this.format.range;for(let i=t,a=e.length;i<a;i+=n)e[i]=M(e[i],r,s)}flipX(){const{data:t,width:e,height:n,stride:[r,s]}=this,i=new Float32Array(r),a=e-1,o=e>>>1;for(let c=0;c<n;c++)for(let l=0,h=c*s,u=h+a*r;l<o;l++,h+=r,u-=r)i.set(t.subarray(h,h+r)),t.copyWithin(h,u,u+r),t.set(i,u);return this}flipY(){const t=this.data,e=this.stride[1],n=new Float32Array(e);for(let r=0,s=t.length-e;r<s;r+=e,s-=e)n.set(t.subarray(r,r+e)),t.copyWithin(r,s,s+e),t.set(n,s);return this}rotateByID(t){return t>0?this[ke[t-1]]():this}rotateCW(){const{width:t,height:e}=this,n=e-1;return this._rotate((r,s)=>r*e+n-s),this.size[0]=e,this.size[1]=t,this}rotateCCW(){const{width:t,height:e}=this,n=t-1;return this._rotate((r,s)=>(n-r)*e+s),this.size[0]=e,this.size[1]=t,this}rotate180(){const{width:t,height:e}=this,n=t-1,r=e-1;return this._rotate((s,i)=>(r-i)*t+n-s),this}invert(){const{data:t,format:e,stride:[n]}=this;for(let r=0,s=t.length,i=e.alpha?n-1:n;r<s;r+=n)for(let a=0;a<i;a++)t[r+a]=1-t[r+a];return this}scale(t,e){return R(t>0,\"scale must be > 0\"),this.resize(this.width*t,this.height*t,e)}resize(t,e,n=\"linear\"){t|=0,e|=0,R(t>0&&e>0,\"target width & height must be > 0\");const r=We(t,e,this.format),s=r.data,i=t>0?this.width/t:0,a=e>0?this.height/e:0,o=this.stride[0];n=Ee(n)?je(this,n,\"repeat\"):n;for(let c=0,l=0;c<e;c++){const h=c*a;for(let u=0;u<t;u++,l+=o)s.set(n(u*i,h),l)}return r}upsize(){const{width:t,height:e,data:n,stride:[r,s]}=this,i=r*2,a=We(t*2,e*2,this.format),o=a.data;for(let c=0,l=0;c<e;c++)for(let h=0,u=c*s*4;h<t;h++,l+=r,u+=i)o.set(n.subarray(l,l+r),u);return a}_rotate(t){const{data:e,width:n,height:r,stride:[s]}=this,i=new Float32Array(n*r*s);for(let a=0,o=0;a<r;a++)for(let c=0;c<n;c++,o+=s)i.set(e.subarray(o,o+s),t(c,a)*s);this.data=i}ensureFormat(t){R(t.format===this.format,\"dest buffer format must be same as src\")}ensureRGBA(){R(this.format===mt,\"require FLOAT_RGBA format\")}};J([st],$.prototype,\"getAt\",1),J([st],$.prototype,\"getAtUnsafe\",1),J([st],$.prototype,\"setAt\",1),J([st],$.prototype,\"setAtUnsafe\",1),$=J([Me],$);const mt=xt({alpha:!0,channels:[v.RED,v.GREEN,v.BLUE,v.ALPHA]}),yt=(t,e=n=>n!==void 0?\": \"+n:\"\")=>class extends Error{origMessage;constructor(n){super(t(n)+e(n)),this.origMessage=n!==void 0?String(n):\"\"}},jr=yt(()=>\"unsupported operation\"),Wt=t=>{throw new jr(t)},S=(t=1,e,...n)=>{const r=[,,].concat(n),s=(...i)=>{const a=r[i[t].length]||e;return a?a(...i):Wt(`no impl for vec size ${i[t].length}`)};return s.add=(i,a)=>r[i]=a,s.default=i=>e=i,s.impl=i=>i!=null&&r[i]||e,s},Lr=(t,e)=>t[0]*e[0]+t[1]*e[1],Yt=(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2],Hr=S(0,(t,e)=>{let n=0;for(let r=t.length;r-- >0;)n+=t[r]*e[r];return n},Lr,Yt,(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]);function Ye(t,e=Object.create(null)){return(...n)=>{const r=JSON.stringify(n);return r!==void 0?r in e?e[r]:e[r]=t.apply(null,n):t.apply(null,n)}}function Ve(t,e=Object.create(null)){return(...n)=>{const r=n.join(\"-\");return r in e?e[r]:e[r]=t(...n)}}const Wr=Ve((t,e)=>t.repeat(e)),Xe=Ye((t,e=!1)=>e?n=>Yr(n)||n.toFixed(t):n=>n.toFixed(t)),Yr=t=>isNaN(t)?\"NaN\":t===1/0?\"+∞\":t===-1/0?\"-∞\":void 0,Vr=(t=0)=>e=>(e*100).toFixed(t)+\"%\",Xr=[.299,.587,.114],Ke=[.2126,.7152,.0722],Kr=[3.1338561,-.9787684,.0719453,-1.6168667,1.9161415,-.2289914,-.4906146,.033454,1.4052427],Zr=[3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252],Jr=[.96422,1,.82521],Qr=[.95047,1,1.08883],ts=[.2104542553,1.9779984951,.0259040371,.793617785,-2.428592205,.7827717662,-.0040720468,.4505937099,-.808675766];let bt=Xe(3),Ze=Vr(3);const G=1/255,Vt=(t,e=Ke)=>Yt(t,e),es=t=>Yt(t,Xr),ns=(t,e)=>(!t&&(t=[]),t[0]=e[0],t[1]=e[1],t),rs=(t,e)=>(!t&&(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],t),L=(t,e)=>(!t&&(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t),ss=S(1,(t,e)=>{!t&&(t=[]);for(let n=e.length;n-- >0;)t[n]=e[n];return t},ns,rs,L),Q=(t,e)=>typeof t?.[e]==\"function\",Xt=t=>t!=null&&typeof t!=\"function\"&&t.length!==void 0,Kt=t=>typeof t==\"number\",At=t=>typeof t==\"string\",os=yt(()=>\"illegal argument(s)\"),Zt=t=>{throw new os(t)},Je=Math.PI,k=Je*2,is=1/k;let E=1e-6;const z=t=>t-Math.floor(t),Qe=(t,e=1)=>Math.round(t/e)*e,as=Ye((t,e=3,n=\",\",r=\"[\",s=\"]\")=>{const i=typeof e==\"number\"?Xe(e):e;switch(t){case 1:return a=>`${r}${i(a[0])}${s}`;case 2:return a=>`${r}${i(a[0])}${n}${i(a[1])}${s}`;case 3:return a=>`${r}${i(a[0])}${n}${i(a[1])}${n}${i(a[2])}${s}`;case 4:return a=>`${r}${i(a[0])}${n}${i(a[1])}${n}${i(a[2])}${n}${i(a[3])}${s}`;default:return a=>{const o=[];for(let c=0;c<a.length;c++)o.push(i(a[c]));return`${r}${o.join(n)}${s}`}}}),cs=(t,e,n,r,s,i)=>{const a=[];for(;n-- >0;)a.push(new t(e,r,s)),r+=i;return a},ls=(t,e,n)=>t<e?e:t>n?n:t,y=t=>t<0?0:t>1?1:t,hs=(t,e=1,n=!0)=>{const r=n?(o,c,l,h)=>{!o&&(o=c);for(let u=c.length;u-- >0;)o[u]=t(c[u],l[u],h[u]);return o}:(o,c,l,h)=>{!o&&(o=h);for(let u=c.length;u-- >0;)o[u]=t(c[u],l[u],h[u]);return o},s=n?(o,c,l,h)=>(!o&&(o=c),o[0]=t(c[0],l[0],h[0]),o[1]=t(c[1],l[1],h[1]),o):(o,c,l,h)=>(!o&&(o=h),o[0]=t(c[0],l[0],h[0]),o[1]=t(c[1],l[1],h[1]),o),i=n?(o,c,l,h)=>(!o&&(o=c),o[0]=t(c[0],l[0],h[0]),o[1]=t(c[1],l[1],h[1]),o[2]=t(c[2],l[2],h[2]),o):(o,c,l,h)=>(!o&&(o=h),o[0]=t(c[0],l[0],h[0]),o[1]=t(c[1],l[1],h[1]),o[2]=t(c[2],l[2],h[2]),o),a=n?(o,c,l,h)=>(!o&&(o=c),o[0]=t(c[0],l[0],h[0]),o[1]=t(c[1],l[1],h[1]),o[2]=t(c[2],l[2],h[2]),o[3]=t(c[3],l[3],h[3]),o):(o,c,l,h)=>(!o&&(o=h),o[0]=t(c[0],l[0],h[0]),o[1]=t(c[1],l[1],h[1]),o[2]=t(c[2],l[2],h[2]),o[3]=t(c[3],l[3],h[3]),o);return[S(e,r,s,i,a),s,i,a]},[Ui,Ei,Ii,fs]=hs(ls),us=fs,ds=(t,e,n,r=!0,s=!0)=>{const i=n>0?r?function(){return this.buf[this.offset+n*this.stride]}:function(){return this.buf[this.offset+n]}:function(){return this.buf[this.offset]},a=n>0?r?function(o){this.buf[this.offset+n*this.stride]=o}:function(o){this.buf[this.offset+n]=o}:function(o){this.buf[this.offset]=o};s&&Object.defineProperty(t,n,{get:i,set:a,enumerable:!0}),Object.defineProperty(t,e,{get:i,set:a,enumerable:!0})},gs=(t,e,n,r)=>e.forEach((s,i)=>ds(t,s,i,n,r)),ms=Math.abs,x=(t,e,n=E)=>ms(t-e)<=n,ys=(t,e,n=E)=>t.length===e.length&&x(t[0],e[0],n)&&x(t[1],e[1],n),bs=(t,e,n=E)=>t.length===e.length&&x(t[0],e[0],n)&&x(t[1],e[1],n)&&x(t[2],e[2],n),tn=(t,e,n=E)=>t.length===e.length&&x(t[0],e[0],n)&&x(t[1],e[1],n)&&x(t[2],e[2],n)&&x(t[3],e[3],n);S(0,(t,e,n=E)=>Q(t,\"eqDelta\")?t.eqDelta(e,n):Q(e,\"eqDelta\")?e.eqDelta(t,n):As(t,e,t.length,n),ys,bs,tn);const As=(t,e,n,r=E,s=0,i=0,a=1,o=1)=>{for(;n>0;n--,s+=a,i+=o)if(!x(t[s],e[i],r))return!1;return!0};function*_s(t,e,n,r){for(;e-- >0;)yield t[n],n+=r}const en=1/2**32;class ps{float(e=1){return this.int()*en*e}probability(e){return this.float()<e}norm(e=1){return(this.int()*en-.5)*2*e}normMinMax(e,n){const r=this.minmax(e,n);return this.float()<.5?r:-r}minmax(e,n){return this.float()*(n-e)+e}minmaxInt(e,n){e|=0;const r=(n|0)-e;return r?e+this.int()%r:e}minmaxUint(e,n){e>>>=0;const r=(n>>>0)-e;return r?e+this.int()%r:e}}class ws extends ps{constructor(e){super(),this.rnd=e}float(e=1){return this.rnd()*e}norm(e=1){return(this.rnd()-.5)*2*e}int(){return this.rnd()*4294967296>>>0}}const Jt=new ws(Math.random),Rs={};var nn={};const $s=yt(()=>\"Assertion failed\"),D=(typeof process<\"u\"&&nn!==void 0?nn.UMBRELLA_ASSERTS:!Rs)?(t,e)=>{if(typeof t==\"function\"&&!t()||!t)throw new $s(typeof e==\"function\"?e():e)}:()=>{},Cs=(t,e,n=Jt)=>{const r=t.length;D(r>0,\"no choices given\");const s=e?t.map((a,o)=>[e[o]||0,a]).sort((a,o)=>o[0]-a[0]):t.map(a=>[1,a]),i=s.reduce((a,o)=>a+o[0],0);return i<=0&&console.warn(\"total weights <= 0\"),()=>{const a=n.float(i);let o=i;for(let c=0;c<r;c++)if(o-=s[c][0],o<=a)return s[c][1]}},vs=S(1,(t,e,n,r=Jt)=>{!t&&(t=e);for(let s=e.length;s-- >0;)t[s]=r.minmax(e[s],n[s]);return t}),rn=Array.isArray,tt={},sn=(t,e)=>{for(let n in e){const r=e[n];if(rn(r)){const[s,i,a,o]=r;e[n]=r.length===2?(c,l)=>i(c,s(c,l)):r.length===3?(c,l)=>a(c,i(c,s(c,l))):(c,l)=>o(c,a(c,i(c,s(c,l))))}}tt[t]={...tt[t],...e}},on=(t,e,n,r)=>{const s=tt[n];D(!!s,`no conversions available for ${n}`);let i=s[r];return i?i(t,e):tt.rgb[r]?s.rgb(t,tt.rgb[r]([],e)):Wt(`can't convert: ${r} -> ${n}`)},an=(t,e)=>(t>>>e|t<<32-e)>>>0,Bs=t=>(t&3840)*4352|(t&240)*272|(t&15)*17,Ss=t=>((t&61440)*69632|(t&3840)*4352|(t&240)*272|(t&15)*17)>>>0;class j{constructor(e,n){this.mode=e,this.value=n}deref(){return this.value}}const Gs={aliceblue:\"f0f8ff\",antiquewhite:\"faebd7\",aqua:\"0ff\",aquamarine:\"7fffd4\",azure:\"f0ffff\",beige:\"f5f5dc\",bisque:\"ffe4c4\",black:\"000\",blanchedalmond:\"ffebcd\",blue:\"00f\",blueviolet:\"8a2be2\",brown:\"a52a2a\",burlywood:\"deb887\",cadetblue:\"5f9ea0\",chartreuse:\"7fff00\",chocolate:\"d2691e\",coral:\"ff7f50\",cornflowerblue:\"6495ed\",cornsilk:\"fff8dc\",crimson:\"dc143c\",cyan:\"0ff\",darkblue:\"00008b\",darkcyan:\"008b8b\",darkgoldenrod:\"b8860b\",darkgray:\"a9a9a9\",darkgreen:\"006400\",darkgrey:\"a9a9a9\",darkkhaki:\"bdb76b\",darkmagenta:\"8b008b\",darkolivegreen:\"556b2f\",darkorange:\"ff8c00\",darkorchid:\"9932cc\",darkred:\"8b0000\",darksalmon:\"e9967a\",darkseagreen:\"8fbc8f\",darkslateblue:\"483d8b\",darkslategray:\"2f4f4f\",darkslategrey:\"2f4f4f\",darkturquoise:\"00ced1\",darkviolet:\"9400d3\",deeppink:\"ff1493\",deepskyblue:\"00bfff\",dimgray:\"696969\",dimgrey:\"696969\",dodgerblue:\"1e90ff\",firebrick:\"b22222\",floralwhite:\"fffaf0\",forestgreen:\"228b22\",fuchsia:\"f0f\",gainsboro:\"dcdcdc\",ghostwhite:\"f8f8ff\",gold:\"ffd700\",goldenrod:\"daa520\",gray:\"808080\",grey:\"808080\",green:\"008000\",greenyellow:\"adff2f\",honeydew:\"f0fff0\",hotpink:\"ff69b4\",indianred:\"cd5c5c\",indigo:\"4b0082\",ivory:\"fffff0\",khaki:\"f0e68c\",lavender:\"e6e6fa\",lavenderblush:\"fff0f5\",lawngreen:\"7cfc00\",lemonchiffon:\"fffacd\",lightblue:\"add8e6\",lightcoral:\"f08080\",lightcyan:\"e0ffff\",lightgoldenrodyellow:\"fafad2\",lightgray:\"d3d3d3\",lightgreen:\"90ee90\",lightgrey:\"d3d3d3\",lightpink:\"ffb6c1\",lightsalmon:\"ffa07a\",lightseagreen:\"20b2aa\",lightskyblue:\"87cefa\",lightslategray:\"789\",lightslategrey:\"789\",lightsteelblue:\"b0c4de\",lightyellow:\"ffffe0\",lime:\"0f0\",limegreen:\"32cd32\",linen:\"faf0e6\",magenta:\"f0f\",maroon:\"800000\",mediumaquamarine:\"66cdaa\",mediumblue:\"0000cd\",mediumorchid:\"ba55d3\",mediumpurple:\"9370db\",mediumseagreen:\"3cb371\",mediumslateblue:\"7b68ee\",mediumspringgreen:\"00fa9a\",mediumturquoise:\"48d1cc\",mediumvioletred:\"c71585\",midnightblue:\"191970\",mintcream:\"f5fffa\",mistyrose:\"ffe4e1\",moccasin:\"ffe4b5\",navajowhite:\"ffdead\",navy:\"000080\",oldlace:\"fdf5e6\",olive:\"808000\",olivedrab:\"6b8e23\",orange:\"ffa500\",orangered:\"ff4500\",orchid:\"da70d6\",palegoldenrod:\"eee8aa\",palegreen:\"98fb98\",paleturquoise:\"afeeee\",palevioletred:\"db7093\",papayawhip:\"ffefd5\",peachpuff:\"ffdab9\",peru:\"cd853f\",pink:\"ffc0cb\",plum:\"dda0dd\",powderblue:\"b0e0e6\",purple:\"800080\",red:\"f00\",rosybrown:\"bc8f8f\",royalblue:\"4169e1\",saddlebrown:\"8b4513\",salmon:\"fa8072\",sandybrown:\"f4a460\",seagreen:\"2e8b57\",seashell:\"fff5ee\",sienna:\"a0522d\",silver:\"c0c0c0\",skyblue:\"87ceeb\",slateblue:\"6a5acd\",slategray:\"708090\",slategrey:\"708090\",snow:\"fffafa\",springgreen:\"00ff7f\",steelblue:\"4682b4\",tan:\"d2b48c\",teal:\"008080\",thistle:\"d8bfd8\",tomato:\"ff6347\",turquoise:\"40e0d0\",violet:\"ee82ee\",wheat:\"f5deb3\",white:\"fff\",whitesmoke:\"f5f5f5\",yellow:\"ff0\",yellowgreen:\"9acd32\",transparent:\"0000\",rebeccapurple:\"639\"};let ks={canvas:\"fff\",canvastext:\"000\",linktext:\"001ee4\",visitedtext:\"4e2386\",activetext:\"eb3323\",buttonface:\"ddd\",buttontext:\"000\",buttonborder:\"000\",field:\"fff\",fieldtext:\"000\",highlight:\"bbd5fb\",highlighttext:\"000\",mark:\"000\",marktext:\"fff\",graytext:\"808080\"};const C=(t,e,n,r)=>(!t&&(t=[]),t[0]=e,t[1]=n,t[2]=r,t),_=(t,e,n,r,s)=>(!t&&(t=[]),t[0]=e,t[1]=n,t[2]=r,t[3]=s,t),_t=(t,e)=>_(t||[],(e>>>16&255)*G,(e>>>8&255)*G,(e&255)*G,(e>>>24)*G),cn=(t,e)=>_(t||[],(e&255)*G,(e>>>8&255)*G,(e>>>16&255)*G,(e>>>24)*G),Ms=t=>{t=(At(t)?t:t.deref()).toLowerCase();const e=Gs[t]||ks[t];if(e||t[0]===\"#\")return new j(\"srgb\",_t([],Es(e||t)));const n=t.split(/[(),/ ]+/),[r,s,i,a,o]=n;switch(D(n.length===5||n.length===6,`invalid color: ${t}`),r){case\"rgb\":case\"rgba\":return new j(\"srgb\",[w(s,1,G,!0),w(i,1,G,!0),w(a,1,G,!0),H(o)]);case\"hsl\":case\"hsla\":return new j(\"hsl\",[Qt(s),ln(i),ln(a),H(o)]);case\"lab\":return new j(\"lab50\",[w(s),w(i,1.25),w(a,1.25),H(o)]);case\"lch\":return new j(r,[w(s),w(i,1.5),Qt(a),H(o)]);case\"oklab\":return new j(r,[w(s,1,1),w(i,.4,1),w(a,.4,1),H(o)]);case\"oklch\":return new j(r,[w(s,1,1),w(i,.4,1),Qt(a),H(o)]);default:Wt(`color mode: ${r}`)}},Us={rad:k,grad:400,turn:1,deg:360},Qt=t=>{const e=/^(-?[0-9.]+)(deg|rad|grad|turn)?$/.exec(t);return D(!!e,`expected hue, got: ${t}`),z(parseFloat(e[1])/(Us[e[2]]||360))},H=t=>t?w(t,1,1,!0):1,ln=(t,e=!0)=>{D(/^([0-9.]+)%$/.test(t),`expected percentage, got: ${t}`);const n=parseFloat(t)/100;return e?y(n):n},w=(t,e=1,n=.01,r=!1)=>{D(/^-?[0-9.]+%?$/.test(t),`expected number or percentage, got: ${t}`);const s=parseFloat(t)*(t.endsWith(\"%\")?.01*e:n);return r?y(s):s},Es=t=>{const e=/^#?([0-9a-f]{3,8})$/i.exec(t);if(e){const n=e[1],r=parseInt(n,16);switch(n.length){case 3:return(Bs(r)|4278190080)>>>0;case 4:return an(Ss(r),8);case 6:return(r|4278190080)>>>0;case 8:return an(r,8)}}return Zt(`invalid hex color: \"${t}\"`)},p=(t,e=1)=>t!=null?y(t):e,Is=t=>{if(typeof t[0]==\"number\")switch(t.length){case 1:return t.push(0,0,1),[t];case 2:return t.push(0,1),[t];case 3:return t.push(1),[t];default:return[t]}return t},pt=t=>{const e=t.channels||{},n=t.order,r=n.length;n.reduce((f,d)=>(f[d]={range:[0,1],...e[d]},f),e);const s=Object.freeze(n.map(f=>e[f].range[0])),i=Object.freeze(n.map(f=>e[f].range[1])),a=L([],s),o=L([],i);a[r-1]=1;const c=n.findIndex(f=>!!e[f].hue),l=class{constructor(f,d=0,g=1){this.offset=d,this.stride=g,this.buf=f||[0,0,0,0],this.offset=d,this.stride=g}buf;get mode(){return t.mode}get length(){return r}get range(){return[s,i]}get[Symbol.toStringTag](){return t.mode}get xyz(){return[this[0],this[1],this[2]]}[Symbol.iterator](){return _s(this.buf,this.length,this.offset,this.stride)}copy(){return new l(this.deref())}copyView(){return new l(this.buf,this.offset,this.stride)}empty(){return new l}deref(){return[this[0],this[1],this[2],this[3]]}set(f){return L(this,f)}clamp(){return c>=0&&(this[c]=z(this[c])),us(null,this,s,i),this}eqDelta(f,d=E){return tn(this,f,d)}randomize(f){return vs(this,a,o,f)}toJSON(){return this.deref()}toString(){return as(4,4)(this)}};gs(l.prototype,n),sn(t.mode,t.from),sn(\"rgb\",{[t.mode]:t.toRgb});const h=(f,d,g)=>{const m=new l(...g);return d!==t.mode?on(m,f,t.mode,d):m.set(f)},u=(f,...d)=>f==null?new l:At(f)?u(Ms(f),...d):Xt(f)?At(f.mode)?h(f,f.mode,d):new l(f,...d):Q(f,\"deref\")?h(f.deref(),f.mode,d):Kt(f)?d.length&&d.every(Kt)?new l(...Is([f,...d])):h(_t([],f),\"srgb\",d):Zt(`can't create a ${t.mode} color from: ${f}`);return u.class=l,u.range=[s,i],u.random=(f,d,g,m)=>new l(d,g,m).randomize(f),u.mapBuffer=(f,d=f.length/r|0,g=0,m=1,b=r)=>cs(l,f,d,g,m,b),u},te=(t,e,n=1)=>(e=z(e)*6,_(t||[],y(Math.abs(e-3)-1),y(2-Math.abs(e-2)),y(2-Math.abs(e-4)),n)),hn=(t,e)=>{const n=e[0];let r=e[1];const s=e[2],i=te(t||e,n,p(e[3])),a=Vt(i);return s<a?r*=s/a:a<1&&(r*=(1-s)/(1-a)),C(i,y((i[0]-a)*r+s),y((i[1]-a)*r+s),y((i[2]-a)*r+s))},zs=(t,e,n=1)=>_(t||e,y(e[0]),y(e[1]),y(e[2]),p(e[3],n)),wt=(t,e,n=1)=>_(t||e,z(e[0]),y(e[1]),y(e[2]),p(e[3],n)),fn=(t,e)=>{t=wt(t||e,e);const n=t[1],r=t[2];if(n<1e-6)return C(t,r,r,r);const s=t[0]*6%6,i=r*(1-n),a=1-Math.abs(s%2-1);let o=3*r*n/(1+a);const c=o*a+i;switch(o+=i,s|0){case 0:return C(t,o,c,i);case 1:return C(t,c,o,i);case 2:return C(t,i,o,c);case 3:return C(t,i,c,o);case 4:return C(t,c,i,o);case 5:return C(t,o,i,c);default:return C(t,i,i,i)}},un=(t,e)=>{const n=y(e[1]),r=y(e[2]);t=te(t||e,e[0],p(e[3]));const s=(1-Math.abs(2*r-1))*n;return C(t,(t[0]-.5)*s+r,(t[1]-.5)*s+r,(t[2]-.5)*s+r)},ee=(t,e)=>{t=wt(t||e,e);const n=t[1],r=t[2];return te(t,e[0],t[3]),C(t,((t[0]-1)*n+1)*r,((t[1]-1)*n+1)*r,((t[2]-1)*n+1)*r)},ne=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,re=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4),Rt=(t,e)=>_(t||e,re(e[0]),re(e[1]),re(e[2]),p(e[3])),xs=(t,e)=>Rt(null,_t(t,e)),Os=(t,e)=>Rt(null,cn(t,e)),se=(t,e=1)=>[Math.cos(t)*e,Math.sin(t)*e],Fs=t=>(t%=k,t<0?k+t:t),dn=(t,e)=>Fs(Math.atan2(t,e)),oe=(t,e)=>{let{1:n,2:r}=e;r*=k;const s=p(e[3]);return n>0?_(t||e,e[0],Math.cos(r)*n,Math.sin(r)*n,s):_(t||e,e[0],0,0,s)},ie=t=>{const e=t**3;return e>.008856?e:(t-16/116)/7.787},gn=(t,e,n=Jr)=>{const r=(e[0]+.16)/1.16;return _(t||e,ie(e[1]/5+r)*n[0],ie(r)*n[1],ie(r-e[2]/2)*n[2],p(e[3]))},Ds=(t,e)=>gn(t,e,Qr),ae=(t,e,n=0,r=0,s=1,i=1)=>t[n]*e[r]+t[n+s]*e[r+i]+t[n+2*s]*e[r+2*i],$t=(t,e,n,r=!1)=>{const s=ae(e,n,0,0,3),i=ae(e,n,1,0,3),a=ae(e,n,2,0,3),o=p(n[3]);return r?_(t||n,y(s),y(i),y(a),o):_(t||n,s,i,a,o)},ce=(t,e,n=Kr)=>$t(t,n,e),le=(t,e)=>ce(t,e,Zr),et=(t,e)=>ce(null,gn(t,e)),mn=(t,e)=>le(null,Ds(t,e)),Ns=[4.0767416621,-1.2684380046,-.0041960863,-3.307711591,2.6097574011,-.7034186147,.2309699292,-.3413193965,1.707614701],yn=(t,{0:e,1:n,2:r,3:s})=>$t(t,Ns,[(e+.3963377774*n+.2158037573*r)**3,(e-.1055613458*n-.0638541728*r)**3,(e-.0894841775*n-1.291485548*r)**3,s]),bn=(t,e)=>e!==0?t/e:0,An=pt({mode:\"rgb\",order:[\"r\",\"g\",\"b\",\"alpha\"],from:{abgr32:(t,e)=>Os(t,e[0]),argb32:(t,e)=>xs(t,e[0]),hcy:hn,hsi:fn,hsl:un,hsv:ee,lab50:et,lab65:mn,lch:[oe,et],oklab:yn,rgb:L,srgb:Rt,xyy:[(t,e)=>{const{0:n,1:r,2:s}=e;return _(t||e,bn(s*n,r),s,bn(s*(1-n-r),r),p(e[3]))},le],xyz50:ce,xyz65:le,ycc:(t,e,n=Ke)=>{const r=e[0],s=(2-2*n[2])*e[1],i=(2-2*n[0])*e[2];return _(t||e,r+i,r-n[2]/n[1]*s-n[0]/n[1]*i,r+s,p(e[3]))}},toRgb:L}),Ts=(t,e)=>{const n=Vt(An(t))+.05,r=Vt(An(e))+.05;return n>r?n/r:r/n},_n=t=>((t==null||!t[Symbol.iterator])&&Zt(`value is not iterable: ${t}`),t),qs=t=>rn(t)?t:[..._n(t)],Ps=t=>Xt(t)?t:[..._n(t)],pn=t=>{const e=bt(z(t[0])*360),n=Ze(y(t[1])),r=Ze(y(t[2])),s=p(t[3]);return s<1?`hsla(${e},${n},${r},${bt(s)})`:`hsl(${e},${n},${r})`},js=(t,e)=>{t=wt(t||e,e);const n=t[1],r=t[2],s=(2-n)*r/2;return t[2]=s,t[1]=s&&s<1?n*r/(s<.5?s*2:2-s*2):n,t},Ls=t=>pn(js([],t)),wn=\"0123456789abcdef\",he=t=>wn[t>>>4&15]+wn[t&15],Hs=t=>he(t>>>8)+he(t&255),Ws=t=>he(t>>>16)+Hs(t),fe=Ve((t,e,n=\"\")=>{const r=Wr(\"0\",e);return s=>(s=(s>>>0).toString(t),n+(s.length<e?r.substring(s.length)+s:s))});fe(2,8),fe(2,16),fe(2,32);const Rn=Ws,ue=t=>{const e=t>>>24;return e<255?`rgba(${t>>16&255},${t>>8&255},${t&255},${bt(e*G)})`:`#${Rn(t&16777215)}`},Ys=t=>(t&255)<<16|t>>16&255|t&4278255360,W=(t,e)=>_(t||e,ne(e[0]),ne(e[1]),ne(e[2]),p(e[3])),de=(t,e=0)=>(t<0?0:t>1?1:t)*255+.5<<e,Y=t=>{const e=de(t[0]),n=de(t[1]),r=de(t[2]),s=p(t[3]);return s<1?`rgba(${e},${n},${r},${bt(s)})`:`#${Rn(e<<16|n<<8|r)}`},$n={abgr32:t=>ue(Ys(t[0])),argb32:t=>ue(t[0]),hsl:pn,hsv:Ls,lab50:t=>Y(W(null,et([],t))),lab65:t=>Y(W(null,mn([],t))),lch:t=>Y(W(null,et(null,oe([],t)))),rgb:t=>Y(W([],t)),srgb:Y};({...$n});let Vs=$n;const Cn=(t,e=Vs)=>{let n;return At(t)?t:Kt(t)?ue(t):t.mode?(n=e[t.mode])?n(t):e.rgb(on([],t,\"rgb\",t.mode)):Y(t)},Xs=(t,e)=>{t=wt(t||e,e);const n=t[1],r=t[2],s=2*r,i=(s+n*(1-Math.abs(s-1)))*.5;return t[1]=2*(i-r)/i,t[2]=i,t},Ks=(t,e)=>{t=zs(t||e,e);const n=t[1]<t[2]?[t[2],t[1],-1,2/3]:[t[1],t[2],0,-1/3],r=t[0]<n[0]?[n[0],n[1],n[3],t[0]]:[t[0],n[1],n[2],n[0]],s=r[0]-Math.min(r[1],r[3]);return C(t,y(Math.abs((r[3]-r[1])/(6*s+E)+r[2])),y(s),y(r[0]))},ge=(t,e)=>(t=Ks(t,e),t[1]/=t[2]+E,t),Zs=pt({mode:\"hsv\",channels:{h:{hue:!0}},order:[\"h\",\"s\",\"v\",\"alpha\"],from:{rgb:ge,srgb:ge,hsl:Xs,lch:[oe,et,W,ge]},toRgb:ee}),Ct=(t,e=1)=>{const n=(a,o,c)=>{!a&&(a=o);for(let l=o.length;l-- >0;)a[l]=t(o[l],c);return a},r=(a,o,c)=>(!a&&(a=o),a[0]=t(o[0],c),a[1]=t(o[1],c),a),s=(a,o,c)=>(!a&&(a=o),a[0]=t(o[0],c),a[1]=t(o[1],c),a[2]=t(o[2],c),a),i=(a,o,c)=>(!a&&(a=o),a[0]=t(o[0],c),a[1]=t(o[1],c),a[2]=t(o[2],c),a[3]=t(o[3],c),a);return[S(e,n,r,s,i),r,s,i]},[Di,Ni,Js]=Ct(Math.pow),Qs=Js,to=[.4122214708,.2119034982,.0883024619,.5363325363,.6806995451,.2817188376,.0514459929,.1073969566,.6299787005],eo=(t,e)=>$t(null,ts,Qs(null,$t(t,to,e),1/3)),vn=(t,e)=>_(t||e,e[0],Math.hypot(e[1],e[2]),dn(e[2],e[1])*is,p(e[3])),no=pt({mode:\"oklch\",channels:{c:{range:[0,.3225]}},order:[\"l\",\"c\",\"h\",\"alpha\"],from:{oklab:vn,rgb:(t,e)=>vn(null,eo(t,e))},toRgb:[(t,e)=>_(t||e,e[0],...se(e[2]*k,e[1]),p(e[3])),yn]}),Bn=pt({mode:\"srgb\",order:[\"r\",\"g\",\"b\",\"alpha\"],from:{abgr32:(t,e)=>cn(t,e[0]),argb32:(t,e)=>_t(t,e[0]),hcy:hn,hsi:fn,hsl:un,hsv:ee,rgb:W},toRgb:Rt}),ro=(t,e)=>t===e?0:t==null?e==null?0:-1:e==null?t==null?0:1:typeof t.compare==\"function\"?t.compare(e):typeof e.compare==\"function\"?-e.compare(t):t<e?-1:t>e?1:0,so=t=>typeof t==\"function\"?t:e=>e[t];function Sn(t,e=ro){const n=so(t);return(r,s)=>e(n(r),n(s))}const oo=(t,e)=>e-t,io=(t,e,n)=>(t-e)/(n-e),ao=(t,e,n,r,s)=>r+(s-r)*io(t,e,n),me=(t,e=1,n=!0)=>{const r=n?(o,c,l)=>{!o&&(o=c);for(let h=c.length;h-- >0;)o[h]=t(c[h],l[h]);return o}:(o,c,l)=>{!o&&(o=l);for(let h=c.length;h-- >0;)o[h]=t(c[h],l[h]);return o},s=n?(o,c,l)=>(!o&&(o=c),o[0]=t(c[0],l[0]),o[1]=t(c[1],l[1]),o):(o,c,l)=>(!o&&(o=l),o[0]=t(c[0],l[0]),o[1]=t(c[1],l[1]),o),i=n?(o,c,l)=>(!o&&(o=c),o[0]=t(c[0],l[0]),o[1]=t(c[1],l[1]),o[2]=t(c[2],l[2]),o):(o,c,l)=>(!o&&(o=l),o[0]=t(c[0],l[0]),o[1]=t(c[1],l[1]),o[2]=t(c[2],l[2]),o),a=n?(o,c,l)=>(!o&&(o=c),o[0]=t(c[0],l[0]),o[1]=t(c[1],l[1]),o[2]=t(c[2],l[2]),o[3]=t(c[3],l[3]),o):(o,c,l)=>(!o&&(o=l),o[0]=t(c[0],l[0]),o[1]=t(c[1],l[1]),o[2]=t(c[2],l[2]),o[3]=t(c[3],l[3]),o);return[S(e,r,s,i,a),s,i,a]},co=(t,e)=>t+e,lo=(t,e)=>t*e,ho=(t,e)=>t-e,[fo,uo]=me(co),Gn=fo,go=uo,mo=Object.freeze([0,0]),yo=Object.freeze([0,0,0]),kn=Math.cos,Mn=Math.sin,Un=S(1);Un.add(2,(t,e,n=mo)=>go(t||e,se(e[1],e[0]),n)),Un.add(3,(t,e,n=yo)=>{const r=e[0],s=e[1],i=e[2],a=kn(s);return C(t||e,r*a*kn(i)+n[0],r*a*Mn(i)+n[1],r*Mn(s)+n[2])});const bo=(t,e)=>{const n=[];for(let r of t)n.push(se(r,e));return n},Ao=t=>D(t.length>0,\"no inputs given\"),[_o]=Ct(lo),En=_o,po=S(0,t=>{let e=0;for(let n=t.length;n-- >0;)e+=t[n];return e},t=>t[0]+t[1],t=>t[0]+t[1]+t[2],t=>t[0]+t[1]+t[2]+t[3]),wo=(t,e)=>{Ao(e),t=ss(t||[],e[0]);for(let n=e.length;n-- >1;)Gn(t,t,e[n]);return En(t,t,1/e.length)},ye=t=>t.length>0?po(t)/t.length:0,[Ro]=Ct(ho),$o=Ro,In=(t,e)=>$o(t,e,ye(e)),Co=t=>dn(t[1],t[0]),vo=S(0,t=>{let e=0;for(let n=t.length;n-- >0;)e+=t[n]*t[n];return e},t=>t[0]*t[0]+t[1]*t[1],t=>t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t=>t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]),Bo=(t,e=!1,n=!1)=>{const r=~~n;return t.length>r?vo(e?t:In([],t))/(t.length-r):0},be=(t,e=!1,n=!1)=>Math.sqrt(Bo(t,e,n)),Ae=t=>Co(wo([],bo(t))),So=(t,e)=>{const n=Ae(e);!t&&(t=[]);for(let r=0,s=e.length;r<s;r++)t[r]=(e[r]-n+Je)%k;return In(null,t)},Go=(t,e)=>be(So([],t),!0,e);me(Math.max);const ko=t=>{let e=-1/0;for(let n=t.length;n-- >0;)e=Math.max(e,t[n]);return e},_e=t=>{if(!t.length)return 0;const e=t.length,n=e>>1;return t=[...t].sort((r,s)=>r-s),e&1?t[n]:(t[n-1]+t[n])*.5};me(Math.min);const Mo=t=>{let e=1/0;for(let n=t.length;n-- >0;)e=Math.min(e,t[n]);return e},Uo=t=>{const[e,n]=we(t);return{min:e,max:n,mean:ye(t),median:_e(t),sd:be(t)}},pe=(t,e)=>{const[n,r]=we(t);return{min:n,max:r,mean:ye(t),median:_e(t),sd:be(t),weighted:Hr(t,e)}},Eo=t=>{const e=t.map(i=>i*k),n=z(Ae(e)/k),[r,s]=Io(t,n);return{min:r,max:s,mean:n,median:zo(t,r,s),sd:Go(e)/k}},we=t=>[Mo(t),ko(t)],Io=(t,e)=>{const n=we(t),[r,s]=n;return e<r||e>s?[t.reduce((i,a)=>{const o=z(e-a);return o<.5&&o>i[1]?[a,o]:i},[s,z(e-s)])[0],t.reduce((i,a)=>{const o=z(a-e);return o<.5&&o>i[1]?[a,o]:i},[r,z(r-e)])[0]]:n},zo=(t,e,n)=>{if(e<=n)return _e(t);const r=t.length,s=r>>1,i=[...t].sort((c,l)=>c-l),a=i.findIndex(c=>c===e),o=i.slice(a).concat(i.slice(0,a));return r&1?o[s]:(o[s-1]+o[s])*.5},xo=t=>typeof t==\"function\",Oo=S(0,(t,e)=>{let n=0;for(let r=t.length;r-- >0;){const s=t[r]-e[r];n+=s*s}return n},(t,e)=>{const n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},(t,e)=>{const n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2];return n*n+r*r+s*s},(t,e)=>{const n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2],i=t[3]-e[3];return n*n+r*r+s*s+i*i});class Fo{constructor(e){this.metric=e}to(e){return e*e}from(e){return Math.sqrt(e)}}const Re=new Fo(Oo),zn=(t,e,n=Re)=>{const r=xo(n)?n:n.metric;let s=1/0,i=-1;for(let a=0,o=e.length;a<o;a++){const c=r(t,e[a]);c<s&&(s=c,i=a)}return i};S(0,(t,e)=>{for(let n=t.length;n-- >0;)t[n]=e;return t},(t,e)=>(t[0]=e,t[1]=e,t),(t,e)=>(t[0]=e,t[1]=e,t[2]=e,t),(t,e)=>(t[0]=e,t[1]=e,t[2]=e,t[3]=e,t));const Do=t=>Array(t).fill(0),No=t=>Array(t).fill(1),To=(t,e,n={})=>{let{dim:r=e[0].length,dist:s=Re,maxIter:i=32,strategy:a=Lo,exponent:o,initial:c,rnd:l}=n;const h=e.length,u=Array.isArray(c)?c:c?c(t,e,s,l):qo(t,e,s,l,o);D(u.length>0,\"missing initial centroids\"),t=u.length;const f=new Uint32Array(h).fill(t);let d=!0;for(;d&&i-- >0&&(d=Po(e,u,f,s),!!d);)for(let g=0;g<t;g++){const m=a(r);for(let A=0;A<h;A++)g===f[A]&&m.update(e[A]);const b=m.finish();b&&(u[g]=b)}return jo(u,f)},qo=(t,e,n=Re,r=Jt,s=2)=>{const i=e.length;D(i>0,\"missing samples\"),t=Math.min(t,i);const a=[r.int()%i],o=[e[a[0]]],c=new Array(i).fill(0).map((h,u)=>u),l=n.metric;for(;a.length<t;){let h=0;const u=e.map(d=>{const g=n.from(l(d,o[zn(d,o,n)]))**s;return h+=g,g});if(!h)break;let f;do f=Cs(c,u,r)();while(a.includes(f));a.push(f),o.push(e[f])}return o},Po=(t,e,n,r)=>{let s=!1;for(let i=t.length;i-- >0;){const a=zn(t[i],e,r);a!==n[i]&&(n[i]=a,s=!0)}return s},jo=(t,e)=>{const n=[];for(let r=0,s=e.length;r<s;r++){const i=e[r];(n[i]||(n[i]={id:i,centroid:t[i],items:[]})).items.push(r)}return n.filter(r=>!!r)},Lo=t=>{const e=Do(t);let n=0;return{update:r=>{Gn(e,e,r),n++},finish:()=>n?En(e,e,1/n):void 0}},Ho=(t,e)=>{const n=[];let r=0;for(let s of e)t(s,r)&&n.push(s),r++;return n},xn=(t,e,n)=>{const r=n?.filter?Ho(n.filter,t):Array.isArray(t)?t:[...t];return r.length?To(Math.min(e,r.length),r,n).sort((s,i)=>i.items.length-s.items.length).map(s=>({color:[...s.centroid],area:s.items.length/r.length,ids:s.items})):[]},On=t=>t;var I=(t=>(t[t.ALPHA=0]=\"ALPHA\",t[t.BLUE=1]=\"BLUE\",t[t.GREEN=2]=\"GREEN\",t[t.RED=3]=\"RED\",t))(I||{});const Fn=t=>((t>>>16&255)*29+(t>>>8&255)*150+(t&255)*76)/255,$e=t=>{const e=t.channels,n=e.reduce((a,o)=>(a[o]=3-o<<3,a),{}),r={...t,__float:!0,size:e.length,shift:n,range:[0,1],normalized:y,fromNormalized:On};if(t.convert)return Object.assign(r,t.convert),r;const s=(a,o)=>(y(a[o])*255+.5|0)<<n[e[o]],i=(a,o)=>(a>>>n[e[o]]&255)/255;switch(e.length){case 1:t.gray?Yo(r):Wo(r,i,s);break;case 2:t.gray?Xo(r,i):Vo(r,i,s);break;case 3:Ko(r,i,s);break;case 4:Zo(r,i,s);break}return r},Wo=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s)},Yo=t=>{t.toABGR=e=>((y(e[0])*255+.5|0)*65793|4278190080)>>>0,t.fromABGR=(e,n=[])=>(n[0]=Fn(e)/255,n)},Vo=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s|=n(r,1),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s[1]=e(r,1),s)},Xo=(t,e)=>{const n=~~(t.channels[0]===I.ALPHA),r=n^1;t.toABGR=s=>{let i=(y(s[n])*255+.5|0)*65793;return i|=(s[r]*255+.5|0)<<24,i>>>0},t.fromABGR=(s,i=[])=>(i[n]=Fn(s)/255,i[r]=e(s,r),i)},Ko=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s|=n(r,1),s|=n(r,2),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s[1]=e(r,1),s[2]=e(r,2),s)},Zo=(t,e,n)=>{t.toABGR=r=>{let s=t.alpha?0:4278190080;return s|=n(r,0),s|=n(r,1),s|=n(r,2),s|=n(r,3),s>>>0},t.fromABGR=(r,s=[])=>(s[0]=e(r,0),s[1]=e(r,1),s[2]=e(r,2),s[3]=e(r,3),s)},Jo=$e({gray:!0,channels:[I.RED]}),vt=Math.abs,Qo=Math.min,ti=$e({alpha:!0,channels:[I.RED,I.GREEN,I.BLUE,I.ALPHA],convert:{fromABGR:(t,e=[])=>{const n=(t>>>24&255)/255,r=(t>>>16&255)/255,s=(t>>>8&255)/255,i=(t&255)/255;let a,o,c,l,h,u,f,d;s<r?(a=r,o=s,c=-1,l=2/3):(a=s,o=r,c=0,l=-1/3),i<a?(h=a,u=o,f=l,d=i):(h=i,u=o,f=c,d=a);const g=h-Qo(u,d);return h=y(h),e[0]=y(vt((d-u)/(6*g+E)+f)),e[1]=y(g/(h+E)),e[2]=h,e[3]=n,e},toABGR:t=>{const e=t[0]*6,n=t[1],r=t[2]*255,s=t[3]*255,i=((y(vt(e-3)-1)-1)*n+1)*r,a=((y(2-vt(e-2))-1)*n+1)*r,o=((y(2-vt(e-4))-1)*n+1)*r;return(s<<24|o<<16|a<<8|i)>>>0}}}),Dn=$e({alpha:!0,channels:[I.RED,I.GREEN,I.BLUE,I.ALPHA]}),Ce=t=>typeof t?.[Symbol.iterator]==\"function\",Nn=(t,e)=>[t[0],t[1],e],ve=Symbol(),Tn=()=>{},Bt=t=>Q(t,\"xform\")?t.xform():t,ei=yt(()=>\"illegal arity\"),Be=t=>{throw new ei(t)};class St{value;constructor(e){this.value=e}deref(){return this.value}}const V=t=>t instanceof St,ni=t=>t instanceof St?t:new St(t),nt=t=>t instanceof St?t.deref():t,ri=t=>t.length===2?[void 0,t[1]]:t.length===3?[t[1],t[2]]:Be(t.length);function Gt(...t){const e=t[0],n=e[0],r=e[1],s=e[2];t=ri(t);const i=t[0]==null?n():t[0],a=t[1];return nt(r(Q(a,\"$reduce\")?a.$reduce(s,i):Xt(a)?si(s,i,a):oi(s,i,a)))}const si=(t,e,n)=>{for(let r=0,s=n.length;r<s;r++)if(e=t(e,n[r]),V(e)){e=e.deref();break}return e},oi=(t,e,n)=>{for(let r of n)if(e=t(e,r),V(e)){e=e.deref();break}return e},Se=(t,e)=>[t,On,e],kt=(t,e)=>{const n=e.length-1;return Ce(e[n])?e.length>1?Gt(t.apply(null,e.slice(0,n)),e[n]):Gt(t(),e[0]):void 0};function qn(t){return t?[...t]:Se(()=>[],(e,n)=>(e.push(n),e))}function*ii(t,e){const n=Bt(t)(qn()),r=n[1],s=n[2];for(let i of e){const a=s([],i);if(V(a)){yield*nt(r(a.deref()));return}a.length&&(yield*a)}yield*nt(r([]))}function*ai(t,e){const n=Bt(t)([Tn,Tn,(r,s)=>s])[2];for(let r of e){let s=n(ve,r);if(V(s)){s=nt(s.deref()),s!==ve&&(yield s);return}s!==ve&&(yield s)}}function rt(t,e){return Ce(e)?ai(rt(t),e):n=>{const r=n[2];return Nn(n,(s,i)=>r(s,t(i)))}}function Pn(t){return t?Gt(Pn(),t):Se(()=>-1/0,(e,n)=>Math.max(e,n))}function*ci(...t){const e=t.length-1;if(e<0)return;const n=new Array(e+1).fill(0),r=t.map(Ps),s=r.reduce((i,a)=>i*a.length,1);for(let i=0;i<s;i++){const a=[];for(let o=e;o>=0;o--){const c=r[o];let l=n[o];l===c.length&&(n[o]=l=0,o>0&&n[o-1]++),a[o]=c[l]}n[e]++,yield a}}function Ge(...t){return li(Ge,Gt,t)}const li=(t,e,n)=>{let r,s;switch(n.length){case 4:s=n[3],r=n[2];break;case 3:s=n[2];break;case 2:return rt(i=>t(n[0],n[1],i));default:Be(n.length)}return e(Bt(n[0])(n[1]),r,s)},[hi]=Ct(Qe),fi=hi,jn=(t,e,n)=>ui(y((n-t)/(e-t))),ui=t=>t*t*(3-2*t);function Ln(...t){let[e,n,r,s,i,a,o,c,l,h]=t;switch(t.length){case 0:Be(0);case 1:return e;case 2:return(...f)=>e(n(...f));case 3:return(...f)=>e(n(r(...f)));case 4:return(...f)=>e(n(r(s(...f))));case 5:return(...f)=>e(n(r(s(i(...f)))));case 6:return(...f)=>e(n(r(s(i(a(...f))))));case 7:return(...f)=>e(n(r(s(i(a(o(...f)))))));case 8:return(...f)=>e(n(r(s(i(a(o(c(...f))))))));case 9:return(...f)=>e(n(r(s(i(a(o(c(l(...f)))))))));case 10:default:const u=(...f)=>e(n(r(s(i(a(o(c(l(h(...f))))))))));return t.length===10?u:Ln(u,...t.slice(10))}}function di(...t){return t=t.map(Bt),Ln.apply(null,t)}function Hn(...t){const e=kt(Hn,t);if(e!==void 0)return e;const[n=0,r=1]=t;return Se(()=>n,(s,i)=>s+r)}const gi=t=>t,mi=t=>({key:e=>e,group:qn(),...t});function Wn(...t){const e=kt(Wn,t);if(e!==void 0)return e;const n=mi(t[0]),[r,s,i]=n.group;return[()=>new Map,a=>{for(let o of a.keys())a.set(o,s(a.get(o)));return a},(a,o)=>{const c=n.key(o);return a.set(c,a.has(c)?i(a.get(c),o):i(r(),o))}]}function Yn(...t){return kt(Yn,t)||Wn({key:t[0]||gi,group:Hn()})}function Vn(...t){const e=kt(Vn,t);if(e!==void 0)return e;const[n,r,s]=Yn(...t);let i=0;return[n,a=>{a=r(a);for(let o of a)a.set(o[0],o[1]/i);return a},(a,o)=>(i++,s(a,o))]}const yi=()=>t=>{const e=t[2];return Nn(t,(n,r)=>{if(r){for(let s of nt(r)||[])if(n=e(n,s),V(n))break}return V(r)?ni(n):n})};function Xn(t,e){return Ce(e)?ii(Xn(t),e):di(rt(t),yi())}function*bi(t,e=1/0){for(;e-- >0;)yield t}const Kn=(t,e=.2,n)=>{const r=qs(t),s=r.filter(u=>u[1]>=e),i=s.length/r.length,a=[...Ge(rt(u=>Qe(u[0],1/12)%1),Vn(),s)].sort(Sn(0)),o=[...Xn(([u,f])=>(f*=50,f>=1?bi(u*k,f):null),a)];if(!o.length)return{hues:a,meanHue:0,temp:0,areaTemp:0,area:0};const c=Ae(o)/k,l=_i(c,n),h=l*i;return{hues:a,meanHue:c,temp:l,areaTemp:h,area:i}},Ai=[.1,.6,.72,.92],_i=(t,[e,n,r,s]=Ai)=>2*(t<2/3?jn(n,e,t):jn(r,s,t))-1,pi=(t,e)=>{let n=t.format!==Dn?t.as(Dn):t;e?.size&&(n=$i(n,e.size));const r=n.as(Jo),s=n.as(ti),i=Ri(n,e),a=i.map(l=>l.area),o=wi(i.map(l=>l.color),a,e?.minSat,e?.tempCoeffs),c=Uo(r.data);return{...o,img:n,imgGray:r,imgHsv:s,lumImg:c,temperature:Kn(s,e?.minSat,e?.tempCoeffs),contrastImg:c.max-c.min}},wi=(t,e=No(t.length),n,r)=>{const s=t.map(f=>es(f)),i=t.map(f=>Bn(f)),a=i.map(f=>Zs(f)),o=i.map(f=>no(f)),c=i.map(f=>Cn(f)),l=a.map(f=>f[0]),h=a.map(f=>f[1]),u=pe(s,e);return{css:c,srgb:i,hsv:a,oklch:o,hue:Eo(l),sat:pe(h,e),chroma:pe(o.map(f=>f[1]),e),lum:u,areas:e,contrast:u.max-u.min,colorContrast:ao(Ge(rt(f=>Ts(...f)),Pn(),ci(i,i)),1,21,0,1),temperature:Kn(a,n,r)}},Ri=(t,{dominantFn:e=xn,numColors:n=4,prec:r=.001}={})=>e(t,n).sort(Sn(\"area\",oo)).map(s=>(fi(null,s.color,r),s)),$i=(t,e)=>{e=~~e;let n=t.width,r=t.height;return[n,r]=n>r?[e,~~Math.max(1,r/n*e)]:[~~Math.max(1,n/r*e),e],t.resize(n,r)};const Ci={numColors:3,lightnessThreshold:.5,yFrom:0,yTo:1,maxSize:320,alphaThreshold:30};const vi=(t,e,n,r={})=>{const{alphaThreshold:s}={...Ci,...r},i={any:!0,left:!0,right:!0,top:!0,bottom:!0};let a={any:0,left:0,right:0,top:0,bottom:0};const o=Math.floor(.15*e),c=Math.floor((n>100?.05:.5)*n),l=Math.floor(e*n*.001);if(e>0&&n>0){for(let h=0;h<e;h++){const u=(0*e+h)*4+3;if(t[u]>s&&(a.top++,a.top>=o)){i.top=!1;break}}for(let h=0;h<e;h++){const u=((n-1)*e+h)*4+3;if(t[u]>s&&(a.bottom++,a.bottom>=o)){i.bottom=!1;break}}for(let h=0;h<n;h++){const u=(h*e+0)*4+3;if(t[u]>s&&(a.left++,a.left>=c)){i.left=!1;break}}for(let h=0;h<n;h++){const u=(h*e+(e-1))*4+3;if(t[u]>s&&(a.right++,a.right>=c)){i.right=!1;break}}if(!i.top&&!i.bottom&&!i.left&&!i.right){for(let h=3;h<t.length;h+=4)if(t[h]>s&&(a.any++,a.any>=l)){i.any=!1;break}}else i.any=!0}return i};const Bi=(t,e,n,r=.5)=>(.299*t+.587*e+.114*n)/255<r;const Si=({buffer:t,imageData:e,width:n,height:r,settings:s,skipTransparencyCheck:i=!1})=>{const{numColors:a,lightnessThreshold:o}=s,c=pi(t,{numColors:a,dominantFn:(d,g)=>xn(d,g,{filter:m=>Bn(m).alpha>0}),prec:.01}),{lumImg:l,srgb:h,areas:u}=c;let f=!1;return!i&&e&&(f=vi(e,n,r,s)),{isDark:l.mean<o,isTransparent:i?!1:f?.any,transparencyInfo:i?null:f,dominantColors:h.map(({r:d,g,b:m},b)=>({color:Cn([d,g,m]),area:u?.[b],isDark:Bi(d*255,g*255,m*255,o)}))}};self.onmessage=async t=>{const{imageBitmap:e,settings:n}=t.data;try{const r=await Gi(e,n);self.postMessage({success:!0,data:r})}catch(r){self.postMessage({success:!1,error:r.message,stack:r.stack})}};async function Gi(t,e){const r={...{numColors:3,lightnessThreshold:.5,yFrom:0,yTo:1,maxSize:600,alphaThreshold:50},...e},{yFrom:s,yTo:i,maxSize:a}=r,o=t.width,c=t.height;if(!o||!c)return!1;let l=1;(o>a||c>a)&&(l=Math.min(a/o,a/c));const h=Math.floor(o*l),u=Math.floor(c*l),f=0,d=Math.floor(s*c),g=Math.max(1,o),m=Math.max(1,Math.ceil((i-s)*c)),b=Math.max(1,h),A=Math.max(1,Math.ceil((i-s)*u)),N=new OffscreenCanvas(b,A);N.getContext(\"2d\").drawImage(t,f,d,g,m,0,0,b,A);const Mt=Pr(N,mt),Zn=new OffscreenCanvas(h,u).getContext(\"2d\");Zn.drawImage(t,0,0,o,c,0,0,h,u);const ki=Zn.getImageData(0,0,h,u).data;return Si({buffer:Mt,imageData:ki,width:h,height:u,settings:r})}})();\n";
